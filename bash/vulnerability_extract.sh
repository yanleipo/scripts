#!/bin/bash

[[ $# < 2 ]] && { echo "Usage: $1 cve_list rhsecapi_scan_result"; echo "cve_list is a file consists of multiple lines with each line consists of package and CVE separated by space";  exit 1; }

cve_list=$1
rhsecapi=$2

echo "--> $cve_list $rhsecapi"
function extract() {
  package=$1
  CVE=$2
  result=`sed -n "/$CVE/,/CVE-/p" $rhsecapi | grep "\[$package\]"`
  echo "$package|$CVE|$result"
}

while read -r line; do
  extract $line
done < $cve_list

